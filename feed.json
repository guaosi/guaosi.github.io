{"title":"guaosi的博客","description":"后端,PHP,Linux,golang,python,开发者,程序猿,程序媛,极客,编程,代码,开源,IT网站,docker","language":"","link":"//www.guaosi.com","pubDate":"Thu, 06 Dec 2018 08:43:14 GMT","lastBuildDate":"Fri, 07 Dec 2018 01:32:24 GMT","generator":"hexo-generator-json-feed","webMaster":"guaosi","items":[{"title":"git pull或git checkout 后保持权限不变","link":"//www.guaosi.com/2018/12/06/git-auto-change/","description":"1. 起因服务器上的项目,一般都是使用用户组www-data或者www\u001c来保证权限安全,不会使用root的。但是git pull下来的新文件或者修改的文件,\u001c则会把原\b有的文件的权限更改为644,\b用户组改为root。 \b如下图所示: 2. 危害\b例如日志文件，异步程序,定时任务\u001d,配置文件之类的，由于最后运行用户的用户\b不对或者权限不够，可能会导致异常\b退出,文件无法读取,日志无法写入等等。所以,这个问题是值得引起我们重视的。 3. 解决办法3.1. 手动解决想法很简单，重新修改文件的权限。比如，回到\b站点上级\b目录，执行如下命令 1234chmod -R 755 www.guaosi.com/# 修改项目内所有文件为755权限chown -R www-data:www-data www.guaosi.com/# 修改项目内所有文件的用户和用户组为www-data 只要不嫌累，每次git pull 或者 git checkout . 后\b退回上级目录执行一次，还是可以舒舒服服解决这个问题的. 3.2. \bgit hook函数接下来是这篇文章的重点了，我们可以使用git内置的钩子函数来解决这个问题. 先来看一下怎么操作: 3.2.1. git pull \b操作1.进入项目目录1cd www.guaosi.com 2.进入.git目录1cd .git/hooks/ 3.新建post-merge文件1vim post-merge 4.写入钩子\b内容1234#!/bin/shpwdecho \"This is post-merge hook\"chmod -R 755 ./* &amp;&amp; chown -R www-data:www-data ./* 5.给予运行权限1chmod +x post-merge 3.2.2. git checkout \b操作1.进入项目目录1cd www.guaosi.com 2.进入.git目录1cd .git/hooks/ 3.新建post-checkout文件1vim post-checkout 4.写入钩子\b内容1234#!/bin/shpwdecho \"This is post-checkout hook\"chmod -R 755 ./* &amp;&amp; chown -R www-data:www-data ./* 5.给予运行权限1chmod +x post-checkout 3.2.3. 原理\b看了\b钩子内容应该大家都明白了，其实就是把手动运行的内容放入了钩子函数。在执行git pull命令时，会自动调用post-merge\b。\b在执行git checkout时,会自动调用git checkout.这样我们以后就不用再操心，怕遗忘权限\b有没有修改的问题了.","pubDate":"Thu, 06 Dec 2018 08:43:14 GMT","guid":"//www.guaosi.com/2018/12/06/git-auto-change/","category":"git"},{"title":"docker常用基础","link":"//www.guaosi.com/2018/11/30/docker-basic/","description":"1. docker用来干什么将做好的环境和代码，打包成镜像，可以让各个地方都可以直接使用，不再受到环境的限制。 2. docker与虚拟机的区别1.虚拟机是模拟整个操作系统，包括硬件部分2.docker是使用linux容器，通过进程隔离，拥有自己的文件系统，不会跟宿主机产生错乱。3.docker没有自己的内核，使用的是宿主机的内核。","pubDate":"Fri, 30 Nov 2018 03:39:18 GMT","guid":"//www.guaosi.com/2018/11/30/docker-basic/","category":"docker"}]}